# Frontend (Next.js 16) Cursor Rules

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã€Next.js 16 + React 19 + shadcn/ui + TailwindCSS 4ã‚’ä½¿ç”¨ã—ãŸãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- **Framework**: Next.js 16 (App Router)
- **Architecture**: Feature-Sliced Design (FSD)
- **UI**: shadcn/ui (Radix UI + TailwindCSS 4)
- **State**: Zustand
- **i18n**: next-intl
- **Package Manager**: Bun

## Feature-Sliced Design (FSD)

### ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ 

```
src/
â”œâ”€â”€ app/          # Application layer (providers, global styles)
â”œâ”€â”€ views/        # Views layer (full page components)
â”œâ”€â”€ widgets/      # Widgets layer (composite UI blocks)
â”œâ”€â”€ features/     # Features layer (business features)
â”œâ”€â”€ entities/     # Entities layer (domain models)
â””â”€â”€ shared/       # Shared layer (reusable code)
```

### ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«

- **ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯èƒ½**: `app` â†’ `views` â†’ `widgets` â†’ `features` â†’ `entities` â†’ `shared`
- **åŒãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆç¦æ­¢**
- **ä¸Šä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆå³ç¦**

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### Rendering Strategy

**é‡è¦**: Next.jså…¬å¼ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å¾“ã†

1. **Public Pages (èªè¨¼ä¸è¦)**: **Server Component (SSR/SSG)** - å¿…é ˆ
   - `'use client'`ã‚’ä½¿ç”¨ã—ãªã„
   - `async`é–¢æ•°ã¨ã—ã¦å®Ÿè£…
   - `getTranslations`ã‚’ä½¿ç”¨ï¼ˆ`useTranslations`ã¯ä¸å¯ï¼‰

2. **Authenticated Pages (èªè¨¼å¿…è¦)**: **Hybrid (SSR + CSR)** - æ¨å¥¨
   - Page wrapper: Server Component
   - ã‚µãƒ¼ãƒãƒ¼å´ã§`await supabase.auth.getUser()`ã§èªè¨¼ãƒã‚§ãƒƒã‚¯
   - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–éƒ¨åˆ†: Client Component

3. **Interactive Components**: **Client Component**
   - `'use client'`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ä½¿ç”¨
   - React Hooksä½¿ç”¨å¯èƒ½

### Supabaseçµ±åˆ

**ğŸ”’ CRITICAL**: Always use `supabase.auth.getUser()`, NEVER `getSession()` in server code

```typescript
// âœ… Good: Server Component with Supabase
import { createClient } from '@/shared/lib/supabase/server'
import { redirect } from 'next/navigation'

export default async function DashboardPage() {
  const supabase = createClient()
  const { data: { user }, error } = await supabase.auth.getUser()

  if (error || !user) redirect('/login')

  return <div>Welcome {user.email}</div>
}
```

### UI Components

**Component Selection Priority**:
1. **First**: MagicUI components (via MCP)
2. **Second**: shadcn/ui components
3. **Last**: Custom components

```bash
# Add shadcn/ui components
bunx shadcn@latest add button card input
```

### Styling

- TailwindCSS 4 utility classes only
- CSS variables for theming (`--background`, `--foreground`, etc.)
- NO custom CSS files
- NO hardcoded colors

```typescript
// âœ… Good
<Card className="border-border bg-background">
  <h2 className="text-foreground">Title</h2>
</Card>

// âŒ Bad
<Card className="border-gray-200" style={{ background: '#fff' }}>
  <h2 className="text-black">Title</h2>
</Card>
```

## Development Commands

```bash
bun install                 # Install dependencies
bun run dev                 # Development server
bun run build               # Production build
bun run lint                # Biome lint
bun run format              # Biome format
bun run type-check          # TypeScript check
bun run test                # Vitest tests
```

## Testing

- **Framework**: Vitest
- **Location**: `__tests__/` directories or `*.test.tsx` files
- **å¿…é ˆ**: å…¨ã¦ã®æ–°æ©Ÿèƒ½ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ã

```typescript
// Example test
import { render, screen } from '@testing-library/react'
import { describe, expect, it } from 'vitest'

describe('Component', () => {
  it('renders correctly', () => {
    render(<Component />)
    expect(screen.getByText('Text')).toBeInTheDocument()
  })
})
```

## é‡è¦ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `frontend/CLAUDE.md` - Frontendè©³ç´°ã‚¬ã‚¤ãƒ‰
- `apps/web/components.json` - shadcn/uiè¨­å®š
- `vitest.config.ts` - ãƒ†ã‚¹ãƒˆè¨­å®š

## ç¦æ­¢äº‹é …

- âŒ `'use client'`ã®ä¸å¿…è¦ãªä½¿ç”¨
- âŒ `getSession()`ã®ä½¿ç”¨ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ï¼‰
- âŒ Custom CSS files
- âŒ Hardcoded colors
- âŒ FSDãƒ¬ã‚¤ãƒ¤ãƒ¼é•åã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- âŒ ESLintã‚„Prettierã®ä½¿ç”¨ï¼ˆBiomeã‚’ä½¿ç”¨ï¼‰
